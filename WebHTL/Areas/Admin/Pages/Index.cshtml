@page
@model WebAppRazorpage.Pages.Areas.Admin.IndexModel
@{
    Layout = "_AdminLayout";
}
<div class="row">
    <div class="col-md-3">
        <div class="card p-30">
            <div class="media">
                <div class="media-left meida media-middle">
                    <span><i class="fa fa-usd f-s-40 color-primary"></i></span>
                </div>
                <div class="media-body media-text-right">
                    <h2>@Model.TotalRevenue.ToString("C")</h2> <!-- Cập nhật giá trị ở đây -->
                    <p class="m-b-0">Month's Revenue</p>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card p-30">
            <div class="media">
                <div class="media-left meida media-middle">
                    <span><i class="fa fa-shopping-cart f-s-40 color-success"></i></span>
                </div>
                <div class="media-body media-text-right">
                    <h2>@Model.TotalOrders</h2> <!-- Cập nhật giá trị ở đây -->
                    <p class="m-b-0">Month's Sales</p>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card p-30">
            <div class="media">
                <div class="media-left meida media-middle">
                    <span><i class="fa fa-archive f-s-40 color-warning"></i></span>
                </div>
                <div class="media-body media-text-right">
                    <h2>@Model.TotalStores</h2> <!-- Cập nhật giá trị ở đây -->
                    <p class="m-b-0">Total Orders</p>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card p-30">
            <div class="media">
                <div class="media-left meida media-middle">
                    <span><i class="fa fa-user f-s-40 color-danger"></i></span>
                </div>
                <div class="media-body media-text-right">
                    <h2>@Model.TotalNewUsers</h2> <!-- Cập nhật giá trị ở đây -->
                    <p class="m-b-0">Month's New Customer</p>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row bg-white m-l-0 m-r-0 box-shadow ">

    <!-- column -->
    <div class="col-lg-8">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Extra Area Chart</h4>
                <div id="extra-area-chart-mounthly"></div>
            </div>
        </div>
    </div>
    <!-- column -->
    <!-- column -->
    <div class="col-lg-4">
        <div class="card">
            <div class="card-body browser">
                <!-- Orders Progress Bar -->
                <p class="f-w-600">Orders <span class="pull-right" id="ordersPercentage">0%</span></p>
                <div class="progress ">
                    <div role="progressbar" style="width: 0%; height:8px;" class="progress-bar bg-primary wow animated progress-animated" id="ordersProgressBar"> <span class="sr-only">Orders Complete</span> </div>
                </div>
    
                <!-- New Users Progress Bar -->
                <p class="m-t-30 f-w-600">New Users<span class="pull-right" id="usersPercentage">0%</span></p>
                <div class="progress">
                    <div role="progressbar" style="width: 0%; height:8px;" class="progress-bar bg-success wow animated progress-animated" id="usersProgressBar"> <span class="sr-only">New Users Complete</span> </div>
                </div>
            </div>
        </div>
    </div>
    <!-- column -->
</div>

<div class="row">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-title">
                <h4>Recent Orders </h4>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Status</th>
                                <th>Total</th>
                                <th>Last Update</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var order in Model.RecentOrdersWithUsers)
                            {
                                <tr>
                                    <td>@(order.Account?.UserName ?? "N/A")</td>
                                    <td>@order.OrderStatus</td>
                                    <td>@order.Total</td>
                                    <td>@order.LastUpdated?.ToString("dd/MM/yyyy HH:mm")</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

@section head{
    <link href="~/admin/assets/css/lib/calendar2/semantic.ui.min.css" rel="stylesheet">
    <link href="~/admin/assets/css/lib/calendar2/pignose.calendar.min.css" rel="stylesheet">
    <link href="~/admin/assets/css/lib/owl.carousel.min.css" rel="stylesheet" />
    <link href="~/admin/assets/css/lib/owl.theme.default.min.css" rel="stylesheet" />
}
@section scripts{
    <!-- Amchart -->
    <script src="~/admin/assets/js/lib/morris-chart/raphael-min.js"></script>
    <script src="~/admin/assets/js/lib/morris-chart/morris.js"></script>
    <script src="~/admin/assets/js/lib/morris-chart/dashboard1-init.js"></script>


    <script src="~/admin/assets/js/lib/calendar-2/moment.latest.min.js"></script>
    <!-- scripit init-->
    <script src="~/admin/assets/js/lib/calendar-2/semantic.ui.min.js"></script>
    <!-- scripit init-->
    <script src="~/admin/assets/js/lib/calendar-2/prism.min.js"></script>
    <!-- scripit init-->
    <script src="~/admin/assets/js/lib/calendar-2/pignose.calendar.min.js"></script>
    <!-- scripit init-->
    <script src="~/admin/assets/js/lib/calendar-2/pignose.init.js"></script>

    <script src="~/admin/assets/js/lib/owl-carousel/owl.carousel.min.js"></script>
    <script src="~/admin/assets/js/lib/owl-carousel/owl.carousel-init.js"></script>

    <script src="~/admin/assets/js/scripts.js"></script>
    <!-- scripit init-->
    <!-- Chart -->
    <script>
        $(function () {
        "use strict";

        // Prepare data for the chart
        var chartData = @Html.Raw(Json.Serialize(ViewData["ChartData"])); // This will hold our chart data

        // Initialize chart with the prepared data
        Morris.Area({
            element: 'extra-area-chart-mounthly',
            data: chartData,
            xkey: 'period',
            ykeys: ['orders', 'users'],
            labels: ['Orders', 'New Users'],
            pointSize: 2,
            fillOpacity: 0.3,
            pointStrokeColors: ['#b4becb', '#01c0c8'],
            behaveLikeLine: true,
            gridLineColor: '#e0e0e0',
            lineWidth: 2,
            smooth: true,
            hideHover: 'auto',
            lineColors: ['#5867dd', '#00c292'],
            resize: true,
            parseTime: false, // Set to false because we are providing dates in 'YYYY-MM-DD' format
            dateFormat: function (x) { return new Date(x).toLocaleDateString(); },
            yLabelFormat: function(y) { return y.toFixed(0); }
        });
        });
    </script>
    <script>
        $(document).ready(function() {
            // Lấy giá trị phần trăm từ ViewData
            var ordersPercentage = '@ViewData["OrdersPercentage"]%';
            var usersPercentage = '@ViewData["UsersPercentage"]%';
    
            // Cập nhật giao diện cho Orders
            $('#ordersPercentage').text(ordersPercentage);
            $('#ordersProgressBar').css('width', ordersPercentage);
    
            // Cập nhật giao diện cho New Users
            $('#usersPercentage').text(usersPercentage);
            $('#usersProgressBar').css('width', usersPercentage);
        });
    </script>
}